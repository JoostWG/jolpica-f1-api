"use strict";var F=Object.create;var h=Object.defineProperty;var Q=Object.getOwnPropertyDescriptor;var I=Object.getOwnPropertyNames;var B=Object.getPrototypeOf,U=Object.prototype.hasOwnProperty;var $=(r,i)=>{for(var e in i)h(r,e,{get:i[e],enumerable:!0})},L=(r,i,e,t)=>{if(i&&typeof i=="object"||typeof i=="function")for(let n of I(i))!U.call(r,n)&&n!==e&&h(r,n,{get:()=>i[n],enumerable:!(t=Q(i,n))||t.enumerable});return r};var j=(r,i,e)=>(e=r!=null?F(B(r)):{},L(i||!r||!r.__esModule?h(e,"default",{value:r,enumerable:!0}):e,r)),E=r=>L(h({},"__esModule",{value:!0}),r);var H={};$(H,{Api:()=>k});module.exports=E(H);var R=j(require("axios"));var l=class extends Error{constructor(e,t){super(t);this.status=e}};var y=class extends l{constructor(e){super(400,e);this.detail=e}};var g=class extends l{constructor(e,t){super(404,t);this.response=e}};var f=class{constructor({cache:i,config:e}={}){this.axios=R.default.create({baseURL:"https://api.jolpi.ca/ergast/f1",validateStatus:t=>t>=200&&t<=299||t>=400&&t<=499,...e}),this.cache=i}async get(i,e,t){if(this.cache){let M=await this.cache.get(i,e);if(M!==null)return M}let n=await this.axios.get(`${i}.json`,{headers:new R.AxiosHeaders().setAccept("application/json"),params:e,...t});if(n.status===404)throw new g(n);if(this.responseIsBadRequest(n))throw new y(n.data.detail);if(n.status!==200)throw new l(n.status);let b=n.data;return this.cache&&await this.cache.set(b,n.headers["Cache-Control"],i,e),b}responseIsBadRequest(i){return i.status===400}};var d=class{constructor(i,e,t,n){this.api=i;this.resource=e;this.options=t;this.transform=n}async get(i){let e=await this.api.get(this.getPath(`/${this.resource}`,this.options),i);return{meta:{limit:Number(e.MRData.limit),offset:Number(e.MRData.offset),total:Number(e.MRData.total)},data:this.transform(e.MRData)}}async getOne(i){let{data:e}=await this.get({limit:1,...i??{}});return e.length>0?e[0]:null}getPath(i,e){let t=[];return e.season&&(t.push(String(e.season)),e.round&&t.push(String(e.round))),e.circuit&&t.push("circuits",e.circuit),e.driver&&t.push("drivers",e.driver),e.team&&t.push("constructors",e.team),e.lap&&t.push("laps",String(e.lap)),e.pitStopNumber&&t.push("pitstops",String(e.pitStopNumber)),e.fastestRank&&t.push("fastest",String(e.fastestRank)),e.gridPosition&&t.push("grid",String(e.gridPosition)),e.finishPosition&&t.push("results",String(e.finishPosition)),e.status&&t.push("status",e.status),e.driverStanding&&t.push("driverstandings",String(e.driverStanding)),e.qualifying&&t.push("qualifying",String(e.qualifying)),e.teamStanding&&t.push("constructorstandings",String(e.teamStanding)),t.length===0?i:`/${t.join("/")}${i}`}};var A=class{constructor(i){this.units=i.units,this.speed=Number(i.speed)}};var S=class{constructor(i){this.latitude=Number(i.lat),this.longitude=Number(i.long),this.locality=i.locality,this.country=i.country}};var a=class{constructor(i,e){this.api=e;this.id=i.circuitId,this.wikiUrl=i.url,this.name=i.circuitName,this.location=new S(i.Location)}};var o=class{constructor(i,e){this.api=e;this.id=i.driverId,this.wikiUrl=i.url,this.firstName=i.givenName,this.lastName=i.familyName,this.dateOfBirth=new Date(i.dateOfBirth),this.nationality=i.nationality,this.number=i.permanentNumber!==void 0?Number(i.permanentNumber):null,this.code=i.code??null}get name(){return`${this.firstName} ${this.lastName}`}get age(){return this.ageAt(new Date)}ageAt(i){let e=i.getFullYear()-this.dateOfBirth.getFullYear();return this.dateOfBirth.getMonth()>i.getMonth()||this.dateOfBirth.getDate()>i.getDate()?e-1:e}circuits(i){return this.api.circuits(this.getOptions(i))}driverStandings(i){return this.api.driverStandings(this.getOptions(i))}laps(i){return this.api.laps(this.getOptions(i))}pitStops(i){return this.api.pitStops(this.getOptions(i))}qualifyingResults(i){return this.api.qualifyingResults(this.getOptions(i))}races(i){return this.api.races(this.getOptions(i))}results(i){return this.api.results(this.getOptions(i))}seasons(i){return this.api.seasons(this.getOptions(i))}sprintResults(i){return this.api.sprintResults(this.getOptions(i))}teams(i){return this.api.teams(this.getOptions(i))}getOptions(i){return{driver:this.id,...i}}};var s=class{constructor(i,e){this.api=e;this.id=i.constructorId??null,this.wikiUrl=i.url??null,this.name=i.name,this.nationality=i.nationality??null}};var T=class{constructor(i,e,t,n){this.api=n;this.season=Number(e),this.round=Number(t),this.position=i.position!==void 0?Number(i.position):null,this.positionText=i.positionText,this.points=Number(i.points),this.wins=Number(i.wins),this.driver=new o(i.Driver,this.api),this.teams=i.Constructors.map(b=>new s(b,this.api))}};var D=class{constructor(i){this.time=i.time}};var c=class{constructor(i){this.rank=Number(i.rank),this.lap=Number(i.lap),this.time=new D(i.Time),this.averageSpeed=i.AverageSpeed!==void 0?new A(i.AverageSpeed):null}};var m=class{constructor(i){this.milliseconds=Number(i.millis),this.time=i.time}};var u=class{constructor(i){this.date=i.date??null,this.time=i.time??null}};var p=class{constructor(i,e){this.api=e;this.season=Number(i.season),this.round=Number(i.round),this.wikiUrl=i.url??null,this.name=i.raceName,this.circuit=new a(i.Circuit,this.api),this.date=i.date,this.time=i.time??null,this.firstPractice=i.FirstPractice!==void 0?new u(i.FirstPractice):null,this.secondPractice=i.SecondPractice!==void 0?new u(i.SecondPractice):null,this.thirdPractice=i.ThirdPractice!==void 0?new u(i.ThirdPractice):null,this.qualifying=i.Qualifying!==void 0?new u(i.Qualifying):null,this.sprint=i.Sprint!==void 0?new u(i.Sprint):null,this.sprintQualifying=i.SprintQualifying!==void 0?new u(i.SprintQualifying):null,this.sprintShootout=i.SprintShootout!==void 0?new u(i.SprintShootout):null}get dateTime(){return new Date(this.time!==null?`${this.date}T${this.time}`:this.date)}};var x=class{constructor(i){this.driverId=i.driverId,this.position=Number(i.position),this.time=i.time}};var v=class{constructor(i,e,t){this.api=t;this.number=Number(i.number),this.timings=i.Timings.map(n=>new x(n)),this.race=new p(e,this.api)}};var O=class{constructor(i,e,t){this.api=t;this.driverId=i.driverId,this.lap=i.lap!==void 0?Number(i.lap):null,this.stop=i.stop!==void 0?Number(i.stop):null,this.time=i.time??null,this.duration=i.duration!==void 0?Number(i.duration):null,this.race=new p(e,this.api)}};var w=class{constructor(i,e,t){this.api=t;this.number=Number(i.number),this.position=i.position!==void 0?Number(i.position):null,this.driver=new o(i.Driver,this.api),this.team=new s(i.Constructor,this.api),this.q1=i.Q1??null,this.q2=i.Q2??null,this.q3=i.Q3??null,this.race=new p(e,this.api)}};var P=class{constructor(i,e,t){this.api=t;this.number=Number(i.number),this.position=i.position,this.positionText=i.positionText,this.points=Number(i.points),this.driver=new o(i.Driver,this.api),this.team=i.Constructor!==void 0?new s(i.Constructor,this.api):null,this.grid=i.grid!==void 0?Number(i.grid):null,this.laps=i.laps!==void 0?Number(i.laps):null,this.status=i.status??null,this.fastestLap=i.FastestLap!==void 0?new c(i.FastestLap):null,this.finishingTime=i.Time!==void 0?new m(i.Time):null,this.race=new p(e,this.api)}get driverAge(){return this.driver.ageAt(this.race.dateTime)}};var q=class{constructor(i,e){this.api=e;this.year=Number(i.season),this.wikiUrl=i.url}};var N=class{constructor(i,e,t){this.api=t;this.number=Number(i.number),this.position=i.position,this.positionText=i.positionText,this.points=Number(i.points),this.driver=new o(i.Driver,this.api),this.team=i.Constructor!==void 0?new s(i.Constructor,this.api):null,this.grid=i.grid!==void 0?Number(i.grid):null,this.laps=i.laps!==void 0?Number(i.laps):null,this.status=i.status??null,this.finishingTime=i.Time!==void 0?new m(i.Time):null,this.fastestLap=i.FastestLap!==void 0?new c(i.FastestLap):null,this.race=new p(e,this.api)}};var C=class{constructor(i,e,t,n){this.api=n;this.season=Number(e),this.round=Number(t),this.position=i.position??null,this.positionText=i.positionText,this.points=Number(i.points),this.wins=Number(i.wins),this.team=new s(i.Constructor,this.api)}};var k=class extends f{circuits(i){return this.makePendingRequest("circuits",e=>e.CircuitTable.Circuits.map(t=>new a(t,this)),i)}driverStandings(i){return new d(this,"driverstandings",i,e=>e.StandingsTable.StandingsLists.flatMap(t=>t.DriverStandings.map(n=>new T(n,t.season,t.round,this))))}drivers(i){return this.makePendingRequest("drivers",e=>e.DriverTable.Drivers.map(t=>new o(t,this)),i)}laps(i){return this.makePendingRequest("laps",e=>e.RaceTable.Races.flatMap(t=>t.Laps.map(n=>new v(n,t,this))),i)}pitStops(i){return this.makePendingRequest("pitstops",e=>e.RaceTable.Races.flatMap(t=>t.PitStops.map(n=>new O(n,t,this))),i)}qualifyingResults(i){return this.makePendingRequest("qualifying",e=>e.RaceTable.Races.flatMap(t=>t.QualifyingResults.map(n=>new w(n,t,this))),i)}races(i){return this.makePendingRequest("races",e=>e.RaceTable.Races.map(t=>new p(t,this)),i)}results(i){return this.makePendingRequest("results",e=>e.RaceTable.Races.flatMap(t=>t.Results.map(n=>new P(n,t,this))),i)}seasons(i){return this.makePendingRequest("seasons",e=>e.SeasonTable.Seasons.map(t=>new q(t,this)),i)}sprintResults(i){return this.makePendingRequest("sprint",e=>e.RaceTable.Races.flatMap(t=>t.SprintResults.map(n=>new N(n,t,this))),i)}teamStandings(i){return this.makePendingRequest("constructorstandings",e=>e.StandingsTable.StandingsLists.flatMap(t=>t.ConstructorStandings.map(n=>new C(n,t.season,t.round,this))),i)}teams(i){return this.makePendingRequest("constructors",e=>e.ConstructorTable.Constructors.map(t=>new s(t,this)),i)}makePendingRequest(i,e,t){return new d(this,i,t??{},e)}};0&&(module.exports={Api});
