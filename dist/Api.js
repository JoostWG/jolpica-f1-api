"use strict";var S=Object.create;var o=Object.defineProperty;var h=Object.getOwnPropertyDescriptor;var d=Object.getOwnPropertyNames;var b=Object.getPrototypeOf,O=Object.prototype.hasOwnProperty;var T=(n,i)=>{for(var e in i)o(n,e,{get:i[e],enumerable:!0})},g=(n,i,e,t)=>{if(i&&typeof i=="object"||typeof i=="function")for(let s of d(i))!O.call(n,s)&&s!==e&&o(n,s,{get:()=>i[s],enumerable:!(t=h(i,s))||t.enumerable});return n};var f=(n,i,e)=>(e=n!=null?S(b(n)):{},g(i||!n||!n.__esModule?o(e,"default",{value:n,enumerable:!0}):e,n)),D=n=>g(o({},"__esModule",{value:!0}),n);var v={};T(v,{Api:()=>R});module.exports=D(v);var l=f(require("axios"));var r=class extends Error{constructor(e,t){super(t);this.status=e}};var p=class extends r{constructor(e){super(400,e);this.detail=e}};var u=class extends r{constructor(i){super(404,i)}};var c=class{constructor(i){this.cache=i;this.axios=l.default.create({baseURL:"https://api.jolpi.ca/ergast/f1",headers:new l.AxiosHeaders().setContentType("application/json")})}async get(i,e){if(this.cache){let a=await this.cache.get(i,e);if(a!==null)return a}let t=await this.axios.get(`${i}.json`,{params:e});if(t.status===404)throw new u;if(this.responseIsBadRequest(t))throw new p(t.data.detail);if(t.status!==200)throw new r(t.status);let s=t.data;return this.cache&&await this.cache.set(s,i,e),s}responseIsBadRequest(i){return i.status===400}};var m=class{createAverageSpeed(i){return{units:i.units,speed:Number(i.speed)}}createCircuit(i){return{id:i.circuitId,wikiUrl:i.url,name:i.circuitName,location:this.createLocation(i.Location)}}createDriverStanding(i){return{position:i.position!==void 0?Number(i.position):null,positionText:i.positionText,points:Number(i.points),wins:Number(i.wins),driver:this.createDriver(i.Driver),teams:i.Constructors.map(this.createTeam.bind(this))}}createFastestLap(i){return{rank:Number(i.rank),lap:Number(i.lap),time:this.createFastestLapTime(i.Time),averageSpeed:this.createAverageSpeed(i.AverageSpeed)}}createDriver(i){return{id:i.driverId,wikiUrl:i.url,firstName:i.givenName,lastName:i.familyName,dateOfBirth:new Date(i.dateOfBirth),nationality:i.nationality,number:i.permanentNumber!==void 0?Number(i.permanentNumber):null,code:i.code??null}}createFastestLapTime(i){return{time:i.time}}createFinishingTime(i){return{milliseconds:Number(i.millis),time:i.time}}createLap(i){return{number:Number(i.number),timings:i.Timings.map(this.createTiming.bind(this))}}createTiming(i){return{driverId:i.driverId,position:Number(i.position),time:i.time}}createLocation(i){return{latitude:Number(i.lat),longitude:Number(i.long),locality:i.locality,country:i.country}}createPitStop(i){return{driverId:i.driverId,lap:i.lap!==void 0?Number(i.lap):null,stop:i.stop!==void 0?Number(i.stop):null,time:i.time??null,duration:i.duration!==void 0?Number(i.duration):null}}createQualifyingResult(i){return{number:Number(i.number),position:i.position!==void 0?Number(i.position):null,driver:this.createDriver(i.Driver),team:this.createTeam(i.Constructor),q1:i.Q1??null,q2:i.Q2??null,q3:i.Q3??null}}createRace(i){return{season:i.season,round:Number(i.round),wikiUrl:i.url??null,name:i.raceName,circuit:this.createCircuit(i.Circuit),date:i.date,time:i.time??null,firstPractice:i.FirstPractice!==void 0?this.createSessionDateTime(i.FirstPractice):null,secondPractice:i.SecondPractice!==void 0?this.createSessionDateTime(i.SecondPractice):null,thirdPractice:i.ThirdPractice!==void 0?this.createSessionDateTime(i.ThirdPractice):null,qualifying:i.Qualifying!==void 0?this.createSessionDateTime(i.Qualifying):null,sprint:i.Sprint!==void 0?this.createSessionDateTime(i.Sprint):null,sprintQualifying:i.SprintQualifying!==void 0?this.createSessionDateTime(i.SprintQualifying):null,sprintShootout:i.SprintShootout!==void 0?this.createSessionDateTime(i.SprintShootout):null}}createResult(i){return{number:Number(i.number),position:i.position,positionText:i.positionText,points:Number(i.points),driver:this.createDriver(i.Driver),team:i.Constructor!==void 0?this.createTeam(i.Constructor):null,grid:i.grid!==void 0?Number(i.grid):null,laps:i.laps!==void 0?Number(i.laps):null,status:i.status??null,fastestLap:this.createFastestLap(i.FastestLap),finishingTime:i.Time!==void 0?this.createFinishingTime(i.Time):null}}createSeason(i){return{year:Number(i.season),wikiUrl:i.url}}createSessionDateTime(i){return{date:i.date??null,time:i.time??null}}createSprintResult(i){return{number:Number(i.number),position:i.position,positionText:i.positionText,points:Number(i.points),driver:this.createDriver(i.Driver),team:i.Constructor!==void 0?this.createTeam(i.Constructor):null,grid:i.grid!==void 0?Number(i.grid):null,laps:i.laps!==void 0?Number(i.laps):null,status:i.status??null,finishingTime:i.Time!==void 0?this.createFinishingTime(i.Time):null,fastestLap:i.FastestLap!==void 0?this.createFastestLap(i.FastestLap):null}}createStatus(i){return{id:i.statusId,count:Number(i.count),name:i.status}}createTeamStanding(i){return{position:i.position??null,positionText:i.positionText,points:Number(i.points),wins:Number(i.wins),team:this.createTeam(i.Constructor)}}createTeam(i){return{id:i.constructorId??null,wikiUrl:i.url??null,name:i.name,nationality:i.nationality??null}}};var R=class extends c{constructor(i){super(i),this.data=new m}async getCircuits(i,e){return await this.getWithOptions("circuits",t=>t.CircuitTable.Circuits.map(this.data.createCircuit.bind(this.data)),i,e)}async getDriverStandings(i,e){return await this.getWithOptions("driverstandings",t=>t.StandingsTable.StandingsLists.length<=0?[]:t.StandingsTable.StandingsLists[0].DriverStandings.map(this.data.createDriverStanding.bind(this.data)),i,e)}async getDrivers(i,e){return await this.getWithOptions("drivers",t=>t.DriverTable.Drivers.map(this.data.createDriver.bind(this.data)),i,e)}async getLaps(i,e){return await this.getWithOptions("laps",t=>t.RaceTable.Races.length<=0?[]:t.RaceTable.Races[0].Laps.map(this.data.createLap.bind(this.data)),i,e)}async getPitStops(i,e){return await this.getWithOptions("pitstops",t=>t.RaceTable.Races.length<=0?[]:t.RaceTable.Races[0].PitStops.map(this.data.createPitStop.bind(this.data)),i,e)}async getQualifyingResults(i,e){return await this.getWithOptions("qualifying",t=>t.RaceTable.Races.length<=0?[]:t.RaceTable.Races[0].QualifyingResults.map(this.data.createQualifyingResult.bind(this.data)),i,e)}async getRaces(i,e){return await this.getWithOptions("races",t=>t.RaceTable.Races.map(this.data.createRace.bind(this.data)),i,e)}async getResults(i,e){return await this.getWithOptions("results",t=>t.RaceTable.Races.length<=0?[]:t.RaceTable.Races[0].Results.map(this.data.createResult.bind(this.data)),i,e)}async getSeasons(i,e){return await this.getWithOptions("seasons",t=>t.SeasonTable.Seasons.map(this.data.createSeason.bind(this.data)),i,e)}async getSprintResults(i,e){return await this.getWithOptions("sprint",t=>t.RaceTable.Races.length<=0?[]:t.RaceTable.Races[0].SprintResults.map(this.data.createSprintResult.bind(this.data)),i,e)}async getTeamStandings(i,e){return await this.getWithOptions("constructorstandings",t=>t.StandingsTable.StandingsLists.length<=0?[]:t.StandingsTable.StandingsLists[0].ConstructorStandings.map(this.data.createTeamStanding.bind(this.data)),i,e)}async getTeams(i,e){return await this.getWithOptions("constructors",t=>t.ConstructorTable.Constructors.map(this.data.createTeam.bind(this.data)),i,e)}async getWithOptions(i,e,t,s){let a=await this.get(this.getPath(`/${i}`,t??{}),s);return{meta:{limit:Number(a.MRData.limit),offset:Number(a.MRData.offset),total:Number(a.MRData.total)},data:e(a.MRData)}}getPath(i,e){let t=[];return e.season&&(t.push(e.season),e.round&&t.push(String(e.round))),e.circuit&&t.push("circuits",e.circuit),e.driver&&t.push("drivers",e.driver),e.team&&t.push("constructors",e.team),e.lap&&t.push("laps",String(e.lap)),e.pitStopNumber&&t.push("pitstops",String(e.pitStopNumber)),e.fastestRank&&t.push("fastest",String(e.fastestRank)),e.gridPosition&&t.push("grid",String(e.gridPosition)),e.finishPosition&&t.push("results",String(e.finishPosition)),e.status&&t.push("status",e.status),t.length===0?i:`/${t.join("/")}${i}`}};0&&(module.exports={Api});
