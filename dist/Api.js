"use strict";var h=Object.create;var o=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var O=Object.getOwnPropertyNames;var b=Object.getPrototypeOf,f=Object.prototype.hasOwnProperty;var D=(r,i)=>{for(var e in i)o(r,e,{get:i[e],enumerable:!0})},S=(r,i,e,t)=>{if(i&&typeof i=="object"||typeof i=="function")for(let s of O(i))!f.call(r,s)&&s!==e&&o(r,s,{get:()=>i[s],enumerable:!(t=d(i,s))||t.enumerable});return r};var T=(r,i,e)=>(e=r!=null?h(b(r)):{},S(i||!r||!r.__esModule?o(e,"default",{value:r,enumerable:!0}):e,r)),v=r=>S(o({},"__esModule",{value:!0}),r);var A={};D(A,{Api:()=>R});module.exports=v(A);var l=T(require("axios"));var a=class extends Error{constructor(e,t){super(t);this.status=e}};var p=class extends a{constructor(e){super(400,e);this.detail=e}};var u=class extends a{constructor(e,t){super(404,t);this.response=e}};var c=class{constructor({cache:i,config:e}){this.axios=l.default.create({baseURL:"https://api.jolpi.ca/ergast/f1",validateStatus:t=>t>=200&&t<=299||t>=400&&t<=499,...e}),this.cache=i}async get(i,e,t){if(this.cache){let g=await this.cache.get(i,e);if(g!==null)return g}let s=await this.axios.get(`${i}.json`,{headers:new l.AxiosHeaders().setAccept("application/json"),params:e,...t});if(s.status===404)throw new u(s);if(this.responseIsBadRequest(s))throw new p(s.data.detail);if(s.status!==200)throw new a(s.status);let n=s.data;return this.cache&&await this.cache.set(n,i,e),n}responseIsBadRequest(i){return i.status===400}};var m=class{createAverageSpeed(i){return{units:i.units,speed:Number(i.speed)}}createCircuit(i){return{id:i.circuitId,wikiUrl:i.url,name:i.circuitName,location:this.createLocation(i.Location)}}createDriverStanding(i,e,t){return{season:e,round:Number(t),position:i.position!==void 0?Number(i.position):null,positionText:i.positionText,points:Number(i.points),wins:Number(i.wins),driver:this.createDriver(i.Driver),teams:i.Constructors.map(this.createTeam.bind(this))}}createFastestLap(i){return{rank:Number(i.rank),lap:Number(i.lap),time:this.createFastestLapTime(i.Time),averageSpeed:i.AverageSpeed!==void 0?this.createAverageSpeed(i.AverageSpeed):null}}createDriver(i){return{id:i.driverId,wikiUrl:i.url,firstName:i.givenName,lastName:i.familyName,dateOfBirth:new Date(i.dateOfBirth),nationality:i.nationality,number:i.permanentNumber!==void 0?Number(i.permanentNumber):null,code:i.code??null}}createFastestLapTime(i){return{time:i.time}}createFinishingTime(i){return{milliseconds:Number(i.millis),time:i.time}}createLap(i,e){return{number:Number(i.number),timings:i.Timings.map(this.createTiming.bind(this)),race:this.createRace(e)}}createTiming(i){return{driverId:i.driverId,position:Number(i.position),time:i.time}}createLocation(i){return{latitude:Number(i.lat),longitude:Number(i.long),locality:i.locality,country:i.country}}createPitStop(i,e){return{driverId:i.driverId,lap:i.lap!==void 0?Number(i.lap):null,stop:i.stop!==void 0?Number(i.stop):null,time:i.time??null,duration:i.duration!==void 0?Number(i.duration):null,race:this.createRace(e)}}createQualifyingResult(i,e){return{number:Number(i.number),position:i.position!==void 0?Number(i.position):null,driver:this.createDriver(i.Driver),team:this.createTeam(i.Constructor),q1:i.Q1??null,q2:i.Q2??null,q3:i.Q3??null,race:this.createRace(e)}}createRace(i){return{season:i.season,round:Number(i.round),wikiUrl:i.url??null,name:i.raceName,circuit:this.createCircuit(i.Circuit),date:i.date,time:i.time??null,firstPractice:i.FirstPractice!==void 0?this.createSessionDateTime(i.FirstPractice):null,secondPractice:i.SecondPractice!==void 0?this.createSessionDateTime(i.SecondPractice):null,thirdPractice:i.ThirdPractice!==void 0?this.createSessionDateTime(i.ThirdPractice):null,qualifying:i.Qualifying!==void 0?this.createSessionDateTime(i.Qualifying):null,sprint:i.Sprint!==void 0?this.createSessionDateTime(i.Sprint):null,sprintQualifying:i.SprintQualifying!==void 0?this.createSessionDateTime(i.SprintQualifying):null,sprintShootout:i.SprintShootout!==void 0?this.createSessionDateTime(i.SprintShootout):null}}createResult(i,e){return{number:Number(i.number),position:i.position,positionText:i.positionText,points:Number(i.points),driver:this.createDriver(i.Driver),team:i.Constructor!==void 0?this.createTeam(i.Constructor):null,grid:i.grid!==void 0?Number(i.grid):null,laps:i.laps!==void 0?Number(i.laps):null,status:i.status??null,fastestLap:i.FastestLap!==void 0?this.createFastestLap(i.FastestLap):null,finishingTime:i.Time!==void 0?this.createFinishingTime(i.Time):null,race:this.createRace(e)}}createSeason(i){return{year:Number(i.season),wikiUrl:i.url}}createSessionDateTime(i){return{date:i.date??null,time:i.time??null}}createSprintResult(i,e){return{number:Number(i.number),position:i.position,positionText:i.positionText,points:Number(i.points),driver:this.createDriver(i.Driver),team:i.Constructor!==void 0?this.createTeam(i.Constructor):null,grid:i.grid!==void 0?Number(i.grid):null,laps:i.laps!==void 0?Number(i.laps):null,status:i.status??null,finishingTime:i.Time!==void 0?this.createFinishingTime(i.Time):null,fastestLap:i.FastestLap!==void 0?this.createFastestLap(i.FastestLap):null,race:this.createRace(e)}}createStatus(i){return{id:i.statusId,count:Number(i.count),name:i.status}}createTeamStanding(i,e,t){return{season:e,round:Number(t),position:i.position??null,positionText:i.positionText,points:Number(i.points),wins:Number(i.wins),team:this.createTeam(i.Constructor)}}createTeam(i){return{id:i.constructorId??null,wikiUrl:i.url??null,name:i.name,nationality:i.nationality??null}}};var R=class extends c{constructor(i={}){super(i),this.data=new m}async getCircuits(i,e){return await this.getWithOptions("circuits",t=>t.CircuitTable.Circuits.map(this.data.createCircuit.bind(this.data)),i,e)}async getDriverStandings(i,e){return await this.getWithOptions("driverstandings",t=>t.StandingsTable.StandingsLists.flatMap(s=>s.DriverStandings.map(n=>this.data.createDriverStanding(n,s.season,s.round))),i,e)}async getDrivers(i,e){return await this.getWithOptions("drivers",t=>t.DriverTable.Drivers.map(this.data.createDriver.bind(this.data)),i,e)}async getLaps(i,e){return await this.getWithOptions("laps",t=>t.RaceTable.Races.flatMap(s=>s.Laps.map(n=>this.data.createLap(n,s))),i,e)}async getPitStops(i,e){return await this.getWithOptions("pitstops",t=>t.RaceTable.Races.flatMap(s=>s.PitStops.map(n=>this.data.createPitStop(n,s))),i,e)}async getQualifyingResults(i,e){return await this.getWithOptions("qualifying",t=>t.RaceTable.Races.flatMap(s=>s.QualifyingResults.map(n=>this.data.createQualifyingResult(n,s))),i,e)}async getRaces(i,e){return await this.getWithOptions("races",t=>t.RaceTable.Races.map(this.data.createRace.bind(this.data)),i,e)}async getResults(i,e){return await this.getWithOptions("results",t=>t.RaceTable.Races.flatMap(s=>s.Results.map(n=>this.data.createResult(n,s))),i,e)}async getSeasons(i,e){return await this.getWithOptions("seasons",t=>t.SeasonTable.Seasons.map(this.data.createSeason.bind(this.data)),i,e)}async getSprintResults(i,e){return await this.getWithOptions("sprint",t=>t.RaceTable.Races.flatMap(s=>s.SprintResults.map(n=>this.data.createSprintResult(n,s))),i,e)}async getTeamStandings(i,e){return await this.getWithOptions("constructorstandings",t=>t.StandingsTable.StandingsLists.flatMap(s=>s.ConstructorStandings.map(n=>this.data.createTeamStanding(n,s.season,s.round))),i,e)}async getTeams(i,e){return await this.getWithOptions("constructors",t=>t.ConstructorTable.Constructors.map(this.data.createTeam.bind(this.data)),i,e)}async getWithOptions(i,e,t,s){let n=await this.get(this.getPath(`/${i}`,t??{}),s);return{meta:{limit:Number(n.MRData.limit),offset:Number(n.MRData.offset),total:Number(n.MRData.total)},data:e(n.MRData)}}getPath(i,e){let t=[];return e.season&&(t.push(e.season),e.round&&t.push(String(e.round))),e.circuit&&t.push("circuits",e.circuit),e.driver&&t.push("drivers",e.driver),e.team&&t.push("constructors",e.team),e.lap&&t.push("laps",String(e.lap)),e.pitStopNumber&&t.push("pitstops",String(e.pitStopNumber)),e.fastestRank&&t.push("fastest",String(e.fastestRank)),e.gridPosition&&t.push("grid",String(e.gridPosition)),e.finishPosition&&t.push("results",String(e.finishPosition)),e.status&&t.push("status",e.status),t.length===0?i:`/${t.join("/")}${i}`}};0&&(module.exports={Api});
