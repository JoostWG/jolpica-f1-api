"use strict";var L=Object.create;var F=Object.defineProperty;var M=Object.getOwnPropertyDescriptor;var I=Object.getOwnPropertyNames;var Q=Object.getPrototypeOf,U=Object.prototype.hasOwnProperty;var B=(n,i,e,t)=>{if(i&&typeof i=="object"||typeof i=="function")for(let r of I(i))!U.call(n,r)&&r!==e&&F(n,r,{get:()=>i[r],enumerable:!(t=M(i,r))||t.enumerable});return n};var G=(n,i,e)=>(e=n!=null?L(Q(n)):{},B(i||!n||!n.__esModule?F(e,"default",{value:n,enumerable:!0}):e,n));var f=G(require("axios"));var l=class extends Error{constructor(e,t){super(t);this.status=e}};var d=class extends l{constructor(e){super(400,e);this.detail=e}};var y=class extends l{constructor(e,t){super(404,t);this.response=e}};var h=class{constructor({cache:i,config:e}={}){this.axios=f.default.create({baseURL:"https://api.jolpi.ca/ergast/f1",validateStatus:t=>t>=200&&t<=299||t>=400&&t<=499,...e}),this.cache=i}async get(i,e,t){if(this.cache){let k=await this.cache.get(i,e);if(k!==null)return k}let r=await this.axios.get(`${i}.json`,{headers:new f.AxiosHeaders().setAccept("application/json"),params:e,...t});if(r.status===404)throw new y(r);if(this.responseIsBadRequest(r))throw new d(r.data.detail);if(r.status!==200)throw new l(r.status);let C=r.data;return this.cache&&await this.cache.set(C,r.headers["Cache-Control"],i,e),C}responseIsBadRequest(i){return i.status===400}};var b=class{constructor(i,e,t,r){this.api=i;this.resource=e;this.options=t;this.transform=r}async get(i){let e=await this.api.get(this.getPath(`/${this.resource}`,this.options),i);return{meta:{limit:Number(e.MRData.limit),offset:Number(e.MRData.offset),total:Number(e.MRData.total)},data:this.transform(e.MRData)}}async getOne(i){let{data:e}=await this.get({limit:1,...i??{}});return e.length>0?e[0]:null}getPath(i,e){let t=[];return e.season&&(t.push(String(e.season)),e.round&&t.push(String(e.round))),e.circuit&&t.push("circuits",e.circuit),e.driver&&t.push("drivers",e.driver),e.team&&t.push("constructors",e.team),e.lap&&t.push("laps",String(e.lap)),e.pitStopNumber&&t.push("pitstops",String(e.pitStopNumber)),e.fastestRank&&t.push("fastest",String(e.fastestRank)),e.gridPosition&&t.push("grid",String(e.gridPosition)),e.finishPosition&&t.push("results",String(e.finishPosition)),e.status&&t.push("status",e.status),t.length===0?i:`/${t.join("/")}${i}`}};var g=class{constructor(i){this.units=i.units,this.speed=Number(i.speed)}};var R=class{constructor(i){this.latitude=Number(i.lat),this.longitude=Number(i.long),this.locality=i.locality,this.country=i.country}};var a=class{constructor(i){this.id=i.circuitId,this.wikiUrl=i.url,this.name=i.circuitName,this.location=new R(i.Location)}};var p=class{constructor(i){this.id=i.driverId,this.wikiUrl=i.url,this.firstName=i.givenName,this.lastName=i.familyName,this.dateOfBirth=new Date(i.dateOfBirth),this.nationality=i.nationality,this.number=i.permanentNumber!==void 0?Number(i.permanentNumber):null,this.code=i.code??null}};var s=class{constructor(i){this.id=i.constructorId??null,this.wikiUrl=i.url??null,this.name=i.name,this.nationality=i.nationality??null}};var S=class{constructor(i,e,t){this.season=Number(e),this.round=Number(t),this.position=i.position!==void 0?Number(i.position):null,this.positionText=i.positionText,this.points=Number(i.points),this.wins=Number(i.wins),this.driver=new p(i.Driver),this.teams=i.Constructors.map(r=>new s(r))}};var T=class{constructor(i){this.time=i.time}};var c=class{constructor(i){this.rank=Number(i.rank),this.lap=Number(i.lap),this.time=new T(i.Time),this.averageSpeed=i.AverageSpeed!==void 0?new g(i.AverageSpeed):null}};var m=class{constructor(i){this.milliseconds=Number(i.millis),this.time=i.time}};var u=class{constructor(i){this.date=i.date??null,this.time=i.time??null}};var o=class{constructor(i){this.season=Number(i.season),this.round=Number(i.round),this.wikiUrl=i.url??null,this.name=i.raceName,this.circuit=new a(i.Circuit),this.date=i.date,this.time=i.time??null,this.firstPractice=i.FirstPractice!==void 0?new u(i.FirstPractice):null,this.secondPractice=i.SecondPractice!==void 0?new u(i.SecondPractice):null,this.thirdPractice=i.ThirdPractice!==void 0?new u(i.ThirdPractice):null,this.qualifying=i.Qualifying!==void 0?new u(i.Qualifying):null,this.sprint=i.Sprint!==void 0?new u(i.Sprint):null,this.sprintQualifying=i.SprintQualifying!==void 0?new u(i.SprintQualifying):null,this.sprintShootout=i.SprintShootout!==void 0?new u(i.SprintShootout):null}};var O=class{constructor(i){this.driverId=i.driverId,this.position=Number(i.position),this.time=i.time}};var D=class{constructor(i,e){this.number=Number(i.number),this.timings=i.Timings.map(t=>new O(t)),this.race=new o(e)}};var x=class{constructor(i,e){this.driverId=i.driverId,this.lap=i.lap!==void 0?Number(i.lap):null,this.stop=i.stop!==void 0?Number(i.stop):null,this.time=i.time??null,this.duration=i.duration!==void 0?Number(i.duration):null,this.race=new o(e)}};var A=class{constructor(i,e){this.number=Number(i.number),this.position=i.position!==void 0?Number(i.position):null,this.driver=new p(i.Driver),this.team=new s(i.Constructor),this.q1=i.Q1??null,this.q2=i.Q2??null,this.q3=i.Q3??null,this.race=new o(e)}};var w=class{constructor(i,e){this.number=Number(i.number),this.position=i.position,this.positionText=i.positionText,this.points=Number(i.points),this.driver=new p(i.Driver),this.team=i.Constructor!==void 0?new s(i.Constructor):null,this.grid=i.grid!==void 0?Number(i.grid):null,this.laps=i.laps!==void 0?Number(i.laps):null,this.status=i.status??null,this.fastestLap=i.FastestLap!==void 0?new c(i.FastestLap):null,this.finishingTime=i.Time!==void 0?new m(i.Time):null,this.race=new o(e)}};var P=class{constructor(i){this.year=Number(i.season),this.wikiUrl=i.url}};var v=class{constructor(i,e){this.number=Number(i.number),this.position=i.position,this.positionText=i.positionText,this.points=Number(i.points),this.driver=new p(i.Driver),this.team=i.Constructor!==void 0?new s(i.Constructor):null,this.grid=i.grid!==void 0?Number(i.grid):null,this.laps=i.laps!==void 0?Number(i.laps):null,this.status=i.status??null,this.finishingTime=i.Time!==void 0?new m(i.Time):null,this.fastestLap=i.FastestLap!==void 0?new c(i.FastestLap):null,this.race=new o(e)}};var N=class{constructor(i,e,t){this.season=Number(e),this.round=Number(t),this.position=i.position??null,this.positionText=i.positionText,this.points=Number(i.points),this.wins=Number(i.wins),this.team=new s(i.Constructor)}};var q=class extends h{circuits(i){return this.makePendingRequest("circuits",e=>e.CircuitTable.Circuits.map(t=>new a(t)),i)}driverStandings(i){return new b(this,"driverstandings",i,e=>e.StandingsTable.StandingsLists.flatMap(t=>t.DriverStandings.map(r=>new S(r,t.season,t.round))))}drivers(i){return this.makePendingRequest("drivers",e=>e.DriverTable.Drivers.map(t=>new p(t)),i)}laps(i){return this.makePendingRequest("laps",e=>e.RaceTable.Races.flatMap(t=>t.Laps.map(r=>new D(r,t))),i)}pitStops(i){return this.makePendingRequest("pitstops",e=>e.RaceTable.Races.flatMap(t=>t.PitStops.map(r=>new x(r,t))),i)}qualifyingResults(i){return this.makePendingRequest("qualifying",e=>e.RaceTable.Races.flatMap(t=>t.QualifyingResults.map(r=>new A(r,t))),i)}races(i){return this.makePendingRequest("races",e=>e.RaceTable.Races.map(t=>new o(t)),i)}results(i){return this.makePendingRequest("results",e=>e.RaceTable.Races.flatMap(t=>t.Results.map(r=>new w(r,t))),i)}seasons(i){return this.makePendingRequest("seasons",e=>e.SeasonTable.Seasons.map(t=>new P(t)),i)}sprintResults(i){return this.makePendingRequest("sprint",e=>e.RaceTable.Races.flatMap(t=>t.SprintResults.map(r=>new v(r,t))),i)}teamStandings(i){return this.makePendingRequest("constructorstandings",e=>e.StandingsTable.StandingsLists.flatMap(t=>t.ConstructorStandings.map(r=>new N(r,t.season,t.round))),i)}teams(i){return this.makePendingRequest("constructors",e=>e.ConstructorTable.Constructors.map(t=>new s(t)),i)}makePendingRequest(i,e,t){return new b(this,i,t??{},e)}};(async()=>{let n=new q,{data:i}=await n.circuits({season:2}).get({limit:5});for(let e of i)console.info(e.name)})();
