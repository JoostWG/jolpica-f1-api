"use strict";var O=Object.create;var c=Object.defineProperty;var P=Object.getOwnPropertyDescriptor;var b=Object.getOwnPropertyNames;var D=Object.getPrototypeOf,v=Object.prototype.hasOwnProperty;var A=(o,i)=>{for(var n in i)c(o,n,{get:i[n],enumerable:!0})},d=(o,i,n,t)=>{if(i&&typeof i=="object"||typeof i=="function")for(let s of b(i))!v.call(o,s)&&s!==n&&c(o,s,{get:()=>i[s],enumerable:!(t=P(i,s))||t.enumerable});return o};var L=(o,i,n)=>(n=o!=null?O(D(o)):{},d(i||!o||!o.__esModule?c(n,"default",{value:o,enumerable:!0}):n,o)),C=o=>d(c({},"__esModule",{value:!0}),o);var x={};A(x,{Api:()=>g,BadRequest:()=>p,BaseApi:()=>u,HttpError:()=>a,NotFound:()=>l,StatusType:()=>f});module.exports=C(x);var m=L(require("axios"));var a=class extends Error{constructor(n,t){super(t);this.status=n}};var p=class extends a{constructor(n){super(400,n);this.detail=n}};var l=class extends a{constructor(n,t){super(404,t);this.response=n}};var u=class{constructor({cache:i,config:n}){this.axios=m.default.create({baseURL:"https://api.jolpi.ca/ergast/f1",validateStatus:t=>t>=200&&t<=299||t>=400&&t<=499,...n}),this.cache=i}async get(i,n,t){if(this.cache){let h=await this.cache.get(i,n);if(h!==null)return h}let s=await this.axios.get(`${i}.json`,{headers:new m.AxiosHeaders().setAccept("application/json"),params:n,...t});if(s.status===404)throw new l(s);if(this.responseIsBadRequest(s))throw new p(s.data.detail);if(s.status!==200)throw new a(s.status);let r=s.data;return this.cache&&await this.cache.set(r,i,n),r}responseIsBadRequest(i){return i.status===400}};var R=class{createAverageSpeed(i){return{units:i.units,speed:Number(i.speed)}}createCircuit(i){return{id:i.circuitId,wikiUrl:i.url,name:i.circuitName,location:this.createLocation(i.Location)}}createDriverStanding(i,n,t){return{season:n,round:Number(t),position:i.position!==void 0?Number(i.position):null,positionText:i.positionText,points:Number(i.points),wins:Number(i.wins),driver:this.createDriver(i.Driver),teams:i.Constructors.map(this.createTeam.bind(this))}}createFastestLap(i){return{rank:Number(i.rank),lap:Number(i.lap),time:this.createFastestLapTime(i.Time),averageSpeed:i.AverageSpeed!==void 0?this.createAverageSpeed(i.AverageSpeed):null}}createDriver(i){return{id:i.driverId,wikiUrl:i.url,firstName:i.givenName,lastName:i.familyName,dateOfBirth:new Date(i.dateOfBirth),nationality:i.nationality,number:i.permanentNumber!==void 0?Number(i.permanentNumber):null,code:i.code??null}}createFastestLapTime(i){return{time:i.time}}createFinishingTime(i){return{milliseconds:Number(i.millis),time:i.time}}createLap(i,n){return{number:Number(i.number),timings:i.Timings.map(this.createTiming.bind(this)),race:this.createRace(n)}}createTiming(i){return{driverId:i.driverId,position:Number(i.position),time:i.time}}createLocation(i){return{latitude:Number(i.lat),longitude:Number(i.long),locality:i.locality,country:i.country}}createPitStop(i,n){return{driverId:i.driverId,lap:i.lap!==void 0?Number(i.lap):null,stop:i.stop!==void 0?Number(i.stop):null,time:i.time??null,duration:i.duration!==void 0?Number(i.duration):null,race:this.createRace(n)}}createQualifyingResult(i,n){return{number:Number(i.number),position:i.position!==void 0?Number(i.position):null,driver:this.createDriver(i.Driver),team:this.createTeam(i.Constructor),q1:i.Q1??null,q2:i.Q2??null,q3:i.Q3??null,race:this.createRace(n)}}createRace(i){return{season:i.season,round:Number(i.round),wikiUrl:i.url??null,name:i.raceName,circuit:this.createCircuit(i.Circuit),date:i.date,time:i.time??null,firstPractice:i.FirstPractice!==void 0?this.createSessionDateTime(i.FirstPractice):null,secondPractice:i.SecondPractice!==void 0?this.createSessionDateTime(i.SecondPractice):null,thirdPractice:i.ThirdPractice!==void 0?this.createSessionDateTime(i.ThirdPractice):null,qualifying:i.Qualifying!==void 0?this.createSessionDateTime(i.Qualifying):null,sprint:i.Sprint!==void 0?this.createSessionDateTime(i.Sprint):null,sprintQualifying:i.SprintQualifying!==void 0?this.createSessionDateTime(i.SprintQualifying):null,sprintShootout:i.SprintShootout!==void 0?this.createSessionDateTime(i.SprintShootout):null}}createResult(i,n){return{number:Number(i.number),position:i.position,positionText:i.positionText,points:Number(i.points),driver:this.createDriver(i.Driver),team:i.Constructor!==void 0?this.createTeam(i.Constructor):null,grid:i.grid!==void 0?Number(i.grid):null,laps:i.laps!==void 0?Number(i.laps):null,status:i.status??null,fastestLap:i.FastestLap!==void 0?this.createFastestLap(i.FastestLap):null,finishingTime:i.Time!==void 0?this.createFinishingTime(i.Time):null,race:this.createRace(n)}}createSeason(i){return{year:Number(i.season),wikiUrl:i.url}}createSessionDateTime(i){return{date:i.date??null,time:i.time??null}}createSprintResult(i,n){return{number:Number(i.number),position:i.position,positionText:i.positionText,points:Number(i.points),driver:this.createDriver(i.Driver),team:i.Constructor!==void 0?this.createTeam(i.Constructor):null,grid:i.grid!==void 0?Number(i.grid):null,laps:i.laps!==void 0?Number(i.laps):null,status:i.status??null,finishingTime:i.Time!==void 0?this.createFinishingTime(i.Time):null,fastestLap:i.FastestLap!==void 0?this.createFastestLap(i.FastestLap):null,race:this.createRace(n)}}createStatus(i){return{id:i.statusId,count:Number(i.count),name:i.status}}createTeamStanding(i,n,t){return{season:n,round:Number(t),position:i.position??null,positionText:i.positionText,points:Number(i.points),wins:Number(i.wins),team:this.createTeam(i.Constructor)}}createTeam(i){return{id:i.constructorId??null,wikiUrl:i.url??null,name:i.name,nationality:i.nationality??null}}};var g=class extends u{constructor(i={}){super(i),this.data=new R}async getCircuits(i,n){return await this.getWithOptions("circuits",t=>t.CircuitTable.Circuits.map(this.data.createCircuit.bind(this.data)),i,n)}async getDriverStandings(i,n){return await this.getWithOptions("driverstandings",t=>t.StandingsTable.StandingsLists.flatMap(s=>s.DriverStandings.map(r=>this.data.createDriverStanding(r,s.season,s.round))),i,n)}async getDrivers(i,n){return await this.getWithOptions("drivers",t=>t.DriverTable.Drivers.map(this.data.createDriver.bind(this.data)),i,n)}async getLaps(i,n){return await this.getWithOptions("laps",t=>t.RaceTable.Races.flatMap(s=>s.Laps.map(r=>this.data.createLap(r,s))),i,n)}async getPitStops(i,n){return await this.getWithOptions("pitstops",t=>t.RaceTable.Races.flatMap(s=>s.PitStops.map(r=>this.data.createPitStop(r,s))),i,n)}async getQualifyingResults(i,n){return await this.getWithOptions("qualifying",t=>t.RaceTable.Races.flatMap(s=>s.QualifyingResults.map(r=>this.data.createQualifyingResult(r,s))),i,n)}async getRaces(i,n){return await this.getWithOptions("races",t=>t.RaceTable.Races.map(this.data.createRace.bind(this.data)),i,n)}async getResults(i,n){return await this.getWithOptions("results",t=>t.RaceTable.Races.flatMap(s=>s.Results.map(r=>this.data.createResult(r,s))),i,n)}async getSeasons(i,n){return await this.getWithOptions("seasons",t=>t.SeasonTable.Seasons.map(this.data.createSeason.bind(this.data)),i,n)}async getSprintResults(i,n){return await this.getWithOptions("sprint",t=>t.RaceTable.Races.flatMap(s=>s.SprintResults.map(r=>this.data.createSprintResult(r,s))),i,n)}async getTeamStandings(i,n){return await this.getWithOptions("constructorstandings",t=>t.StandingsTable.StandingsLists.flatMap(s=>s.ConstructorStandings.map(r=>this.data.createTeamStanding(r,s.season,s.round))),i,n)}async getTeams(i,n){return await this.getWithOptions("constructors",t=>t.ConstructorTable.Constructors.map(this.data.createTeam.bind(this.data)),i,n)}async getWithOptions(i,n,t,s){let r=await this.get(this.getPath(`/${i}`,t??{}),s);return{meta:{limit:Number(r.MRData.limit),offset:Number(r.MRData.offset),total:Number(r.MRData.total)},data:n(r.MRData)}}getPath(i,n){let t=[];return n.season&&(t.push(n.season),n.round&&t.push(String(n.round))),n.circuit&&t.push("circuits",n.circuit),n.driver&&t.push("drivers",n.driver),n.team&&t.push("constructors",n.team),n.lap&&t.push("laps",String(n.lap)),n.pitStopNumber&&t.push("pitstops",String(n.pitStopNumber)),n.fastestRank&&t.push("fastest",String(n.fastestRank)),n.gridPosition&&t.push("grid",String(n.gridPosition)),n.finishPosition&&t.push("results",String(n.finishPosition)),n.status&&t.push("status",n.status),t.length===0?i:`/${t.join("/")}${i}`}};var f=(e=>(e.Finished="1",e.Plus1Lap="11",e.Engine="5",e.Plus2Laps="12",e.Accident="3",e.Collision="4",e.Gearbox="6",e.SpunOff="20",e.Plus3Laps="13",e.Suspension="22",e.Plus4Laps="14",e.Transmission="7",e.Electrical="10",e.Lapped="143",e.Brakes="23",e.Withdrew="54",e.Retired="31",e.Plus5Laps="15",e.Clutch="8",e.NotClassified="62",e.FuelSystem="69",e.Plus6Laps="16",e.Disqualified="2",e.Turbo="101",e.Hydraulics="9",e.Overheating="25",e.Ignition="80",e.OilLeak="44",e.Throttle="37",e.OutOfFuel="60",e.Plus7Laps="17",e.Halfshaft="86",e.Wheel="36",e.OilPressure="51",e.FuelPump="48",e.Differential="24",e.Tyre="27",e.Handling="64",e.Plus8Laps="18",e.FuelLeak="95",e.CollisionDamage="130",e.Steering="38",e.Radiator="21",e.PowerUnit="131",e.Puncture="29",e.Plus9Laps="19",e.WheelBearing="67",e.Injection="98",e.FuelPressure="32",e.Plus10Laps="88",e.WaterLeak="47",e.Alternator="91",e.Physical="68",e.Exhaust="43",e.Chassis="83",e.Mechanical="26",e.Magneto="121",e.Driveshaft="30",e.Axle="109",e.HeatShieldFire="42",e.Plus11Laps="45",e.Battery="84",e.Distributor="99",e.OilPump="94",e.PowerLoss="75",e.Plus13Laps="53",e.Injury="82",e.Plus12Laps="55",e.Plus14Laps="111",e.OilPipe="108",e.BrokenWing="41",e.Electronics="40",e.DriverUnwell="100",e.Vibrations="76",e.Plus15Laps="112",e.DidNotStart="142",e.RearWing="65",e.WheelNut="61",e.Excluded="96",e.WaterPressure="34",e.Plus16Laps="116",e.Plus17Laps="50",e.Injured="73",e.WaterPump="103",e.ERS="132",e.FrontWing="33",e.Supercharger="126",e.Plus18Laps="114",e.Plus19Laps="124",e.Plus22Laps="115",e.Plus24Laps="117",e.Fuel="74",e.Pneumatics="63",e.Technical="39",e.Plus25Laps="113",e.FatalAccident="104",e.Fire="66",e.FuelPipe="106",e.SparkPlugs="105",e.Undertray="140",e.WaterPipe="110",e.WheelRim="46",e.Damage="137",e.Drivetrain="79",e.FuelRig="71",e.Illness="139",e.OilLine="70",e.Safety="78",e.SafetyConcerns="89",e.Stalled="85",e.TrackRod="49",e.Plus20Laps="127",e.Plus21Laps="120",e.Plus23Laps="119",e.Plus26Laps="58",e.Plus29Laps="118",e.Plus30Laps="123",e.Plus42Laps="128",e.Plus44Laps="122",e.Plus46Laps="125",e.BrakeDuct="135",e.CoolingSystem="141",e.Crankshaft="87",e.CVJoint="102",e.Debris="138",e.DriverSeat="28",e.EngineFire="56",e.EngineMisfire="129",e.EyeInjury="107",e.LaunchControl="72",e.NotRestarted="90",e.Refuelling="35",e.SafetyBelt="93",e.Seat="136",e.TyrePuncture="59",e.Underweight="92",e))(f||{});0&&(module.exports={Api,BadRequest,BaseApi,HttpError,NotFound,StatusType});
